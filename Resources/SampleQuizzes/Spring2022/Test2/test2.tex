%%\def\beginanswers{\iffalse}
\def\beginanswers{\iftrue}

\documentclass[10pt]{article}
\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage{listings}
\input{cs1.tex}

\newcommand{\vect}[1]{{\bf #1}}                 %for bold chars
\newcommand{\vecg}[1]{\mbox{\boldmath $ #1 $}}  %for bold greek chars
\newcommand{\matx}[1]{{\bf #1}}

\setlength{\parindent}{0in}
\setlength{\parskip}{1em}
\setlength{\textheight}{9.5in}
\setlength{\textwidth}{7in}
\setlength{\headsep}{0in}        % distance from top of page to address
\setlength{\topmargin}{-0.5in}
\setlength{\oddsidemargin}{-0.5in}
\setlength{\evensidemargin}{-0.5in}


\begin{document}
\thispagestyle{empty}

\vspace*{0.5in}

\begin{center}
\Large
\textbf{Open Source Software --- CSCI-4470 --- Spring 2022} \\
\textbf{Test 2} \\
\textbf{April 15, 2022}
\end{center}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\beginanswers
\begin{center}
\Large
\textbf{SOLUTIONS}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{center}

\textbf{\Large Name:} \underline {\hspace{2.0in}} \\

\bigskip
\bigskip

\centerline{
\includegraphics[height=0.5in]{boxes}
}

%%  \begin{tabular}{|p{0.1in}|p{0.1in}|p{0.1in}|p{0.1in}|p{0.1in}|p{0.1in}|p{0.1in}|p{0.1in}|l|}
%%    \hline \\
%%   & & & & & & & & \textbf{\large @rpi.edu} \\
%%  \hline
%%  \end{tabular} 
%%  
%%  \end{tabular}

\bigskip

\textbf{\Large RIN\#:} \underline {\hspace{1.5in}}  

\vspace*{0.4in}
{\large\bf Honor pledge: On my honor I have neither given
nor received aid on this exam.}

\vspace*{0.1in}
{\large\bf Please sign here to indicate that you agree with the honor pledge: \underline {\hspace{1.5in}}}
\end{center}

\vspace*{.45in} 

{\large\bf Instructions:}
\begin{itemize}
%%\item You have 90 minutes to complete this test.
\item Clearly print your name, RCS ID (in all caps.) and your RIN at the top of your exam.
\item This test is open book, open notes and open computer. You \textbf{may not} use the internet. Please turn off your wifi.
\item There are \textbf{5 questions} on this test worth a total of
  \textbf{100 points}.
\end{itemize}

\centering{\begin{tabular}{|c|c|r|}
	\hline
	Question & Score & Possible \\ \hline
	1 &  & 20 \\ \hline
	2 &  & 20 \\ \hline
	3 &  & 20 \\ \hline
	4 &  & 20 \\ \hline
	5 &  & 20 \\ \hline
	Total &  & 100 \\ \hline
\end{tabular}}

\newpage

%% ^\d?[\( ]?(\d{3})[- \)]*\d{3}[- \)]*\d{4}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{enumerate}
	%% Spring 2022
	\item (20 points) The code below is  the \textbf{Word Ladder} example we did 
		in lab. Refer to it to answer the questions below.


		\lstinputlisting{code/Scientific/main.py}

		%%\newpage

		\beginanswers
		\begin{enumerate}

			\newpage

			\item (2 of 20 points) For the graph, what information is stored in the nodes?
				
				\bigskip
				Words
				\bigskip

			\item (2 of 20 points) What does an edge between 2 nodes represent?

				\bigskip
				The words connected by edges differ by one letter.
				\bigskip

			\item (2 of 20 points) Which line generates an empty graph?
			
				\bigskip
				G = nx.Graph(name="words")
				\bigskip

			\item (4 of 20 points) Explain what the following lines of code (lines 13 and 14) do:
\begin{lstlisting}
	candgen = ((word, cand) for word in sorted(words) for cand in edit_distance_one(word) if cand in words)
\end{lstlisting}
\bigskip
For each word in the set of all words in the dictionary, it generates all tuples matching the given word with other words in the dictionary such that they only differ by one letter.
\bigskip

			\item (2 of 20 points) Will this code generate the \verb|(word, cand)| pair \verb|('force', 'farce')|"?

\bigskip
No
\bigskip

			\item (2 of 20 points) Will this code generate an edge between \verb|(word, cand)| pair \verb|('force', 'farce')|"? Why or why not?
			
\bigskip
Yes. Edges are bi-directional and the code will generate the verb|(word, cand)| pair \verb|('farce', 'force')|
\bigskip

		\item (6 of 20 points) Modify the code above to only allow changes to the even numbered character positions. Assume that the first letter of a string (position 0) counts as even. This will prohibit, for example, a path from \verb*|force| to \verb*|farce|. You do not need to rewrite the entire code above. Just concisely indicate using the line numbers above which lines need to change, what they would change to,  and where you would insert any new code.
			\bigskip
			
			Change line \#8 to read:
							\begin{lstlisting}
            		 for i in range(0, len(word), 2): #8
				\end{lstlisting}
				\bigskip
                \end{enumerate}
		\else
		\begin{enumerate}
			\item (2 of 20 points) For the graph, what information is stored in the nodes?
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip

			\item (2 of 20 points) What does an edge between 2 nodes represent?
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip

			\item (2 of 20 points) Which line generates an empty graph?
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
	

			\item (4 of 20 points) Explain what the following lines of code (lines 13 and 14) do:
\begin{lstlisting}
candgen = ((word, cand) for word in sorted(words) for cand in edit_distance_one(word) if cand in words)
\end{lstlisting}
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
		
		\item (2 of 20 points) Will this code generate the \verb|(word, cand)| pair \verb|('force', 'farce')|"?
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip

		\item (2 of 20 points) Will this code generate an edge between \verb|(word, cand)| pair \verb|('force', 'farce')|"? Why or why not?
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip

		\item (6 of 20 points) Modify the code above to only allow changes to the even numbered character positions. Assume that the first letter of a string (position 0) counts as even. This will prohibit, for example, a path from \verb*|force| to \verb*|farce|. You do not need to rewrite the entire code above. Just concisely indicate using the line numbers above which lines need to change, what they would change to,  and where you would insert any new code.
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
				\bigskip
                \end{enumerate}
		\fi

\newpage

    \item Assume you have a couchDB instance running on \verb*|localhost:5984| with administrator \verb*|admin| and password \verb*|admin|. Also consider the following table of data:
    
    \begin{center}
    	
    	\begin{tabular}{|c|c|c|} \hline
    	\textbf{First} & \textbf{Last} & \textbf{Beverage}  \\ \hline
    	Wesley & Turner & Coffee  \\ \hline 
    	Louie & Dog & Puddle Water  \\ \hline 
    	Bugs & Bunny & Carrot Juice  \\ \hline 
    	\end{tabular}
    
    \end{center}
    
    Each question below has a description of the desired operation and the output returned. Provide one or more \verb*|curl| command that implement the operation. You may need results from a previous \verb*|curl| commend
    in formulating new commands. You should use the provided output when that is the case.
    
    For example:
    
    \# Get the welcome message
\begin{lstlisting}
curl http://localhost:5984/
\end{lstlisting}
        Response:
	\begin{lstlisting}
	{"couchdb":"Welcome","version":"3.2.1","git_sha":"244d428af","uuid":"a3cc56d36b644ee376e45661aeacf43b",\
		"features":["access-ready","partitioned","pluggable-storage-engines",\
		"reshard","scheduler"],"vendor":{"name":"The Apache Software Foundation"}}
    \end{lstlisting}
 
\begin{enumerate}
	
	\item \textbf{(2/20 points)} \# Get 3 UUIDs 
	
		\beginanswers	
		
			\begin{lstlisting}
			>  curl http://localhost:5984/_uuids?count=3
			\end{lstlisting}
		
		\else

\hspace*{-0.4in}\framebox(500,50){}

		\fi
	
	Response:
	\begin{lstlisting}
{"uuids":["940012ba002b8d0de8239245980028ea","940012ba002b8d0de823924598002bfb",\
	"940012ba002b8d0de823924598002d2e"]}
	\end{lstlisting}

	\item \textbf{(2/20 points)} \# Create a drinks database 
	
\beginanswers	
\begin{lstlisting}
	> curl -X PUT http://admin:admin@127.0.0.1:5984/drinks
\end{lstlisting}
\else


\hspace*{-0.4in}\framebox(500,50){}


\fi

Response:
\begin{lstlisting}
	{"ok":true}
\end{lstlisting}

\newpage

	\item \textbf{(4/20 points)} \# Add \verb*|Wes| into the database You can assume Louie and Bugs are added as well. The output lines show the return from all three calls in order: \verb*|Wes|, \verb*|Louie|, \verb*|Bugs|. 

\beginanswers	
\begin{lstlisting}
	> curl -X PUT \ http://admin:admin@127.0.0.1:5984/drinks/940012ba002b8d0de8239245980028ea \
	-d '{"First
		":"Wes","Last":"Turner", "Beverage":"Coffee"}'
   
    > curl -X PUT \ http://admin:admin@127.0.0.1:5984/drinks/940012ba002b8d0de823924598002bfb \
    -d '{"First
    	":"Louie","Last":"Dog", "Beverage":"Puddle Water"}' # Not required
    
 	> curl -X PUT \ http://admin:admin@127.0.0.1:5984/drinks/940012ba002b8d0de823924598002d2e \
 	-d '{"First
	":"Bugs","Last":"Bunny", "Beverage":"Carrot Juice"}' # Not required
\end{lstlisting}
\else


\hspace*{-0.4in}\framebox(500,75){}


\fi
Response:
\begin{lstlisting}
{"ok":true,"id":"940012ba002b8d0de8239245980028ea",\
	"rev":"1-ed659d44c0462a25310f95c44351b8ba"}
{"ok":true,"id":"940012ba002b8d0de823924598002bfb",\
	"rev":"1-62cb2c4f3be74e4922a12ed67e9c73ef"}
{"ok":true,"id":"940012ba002b8d0de823924598002d2e",\
	"rev":"1-79af28dadc0a850156201b3842e703f0"}
\end{lstlisting}

	\item \textbf{(4/20 points)} \# We are out of coffee, and I refuse to drink \verb|Puddle Water|. Change my document to show I am drinking \verb|Carrot Juice|. 

\beginanswers	
\begin{lstlisting}

curl -X PUT \ http://admin:admin@127.0.0.1:5984/drinks/940012ba002b8d0de8239245980028ea \
-d '{"_rev"
	:"1-ed659d44c0462a25310f95c44351b8ba","First":"Wes","Last":"Turner", "Beverage":"Carrot Juice"}'

\end{lstlisting}
\else


\hspace*{-0.4in}\framebox(500,100){}


\fi
Response:
\begin{lstlisting}

{"ok":true,"id":"940012ba002b8d0de8239245980028ea",\
	"rev":"2-a320f8bd37b1aaddac6ba2765fcf3441"}

\end{lstlisting}

\newpage

	\item \textbf{(4/20 points)} \# Set up an index on \verb*|"Beverage"| called \verb*|beverage-index| that can be used to quickly search the \verb*|drinks| database.

\beginanswers	
\begin{lstlisting}
	
	curl -X POST admin:admin@localhost:5984/drinks/_index -d '{
	"index": {
		"fields": [
		"Beverage"
		]
	},
	"name": "beverage-index",
	"type": "json"
}' -H 'Content-Type: application/json'
	
\end{lstlisting}
\else


\hspace*{-0.4in}\framebox(500,200){}


\fi
Response:
\begin{lstlisting}
	
	{"result":"created","id":"_design/3661a151d6a8590d6e00836a30910faa25247eaf",\
		"name":"beverage-index"}

\end{lstlisting}
	\item \textbf{(4/20 points)} \# Now search for everone who drinks \verb|Carrot Juice|.

\beginanswers	
\begin{lstlisting}

	curl -X POST admin:admin@localhost:5984/drinks/_find -d '{
		"selector": {
			"Beverage": {
				"$eq": "Carrot Juice"
			}
		}
	}' -H 'Content-Type: application/json'

\end{lstlisting}
\else


\hspace*{-0.4in}\framebox(500,200){}


\fi
Response:
\begin{lstlisting}
	
	{"docs":[
	{"_id":"940012ba002b8d0de8239245980028ea","_rev":"2-a320f8bd37b1aaddac6ba2765fcf3441",\
		"First":"Wes","Last":"Turner","Beverage":"Carrot Juice"},
	{"_id":"940012ba002b8d0de823924598002d2e","_rev":"1-79af28dadc0a850156201b3842e703f0",\
		"First":"Bugs","Last":"Bunny","Beverage":"Carrot Juice"}
	],
	"bookmark": "g1AAAABieJzLYWBgYMpgSmHgKy5JLCrJTq2MT8lPzkzJBYorWJoYG\
	BgaJSUaGBglWaQYpKRaGBlbGpmYWloARVKMUkH6OGD6coA6GEHaeJwTi4\
	rySxS8SjOTU7OyAOBGGh4"}
	
\end{lstlisting}

\end{enumerate}

\newpage

\item (20 points) Refer to the \textbf{Github Action} template for the action yaml file shown and the python file for the \verb*|Mystery| class below while
	answering the following questions.
	
\lstinputlisting{code/Testing/super-linter.yml}

\lstinputlisting{code/Testing/Mystery.py}

\begin{enumerate}
	\item (2 of 20 points) In the yaml file, which repository contains  the command that \textbf{runs} the test?
	
	\beginanswers
		\textbf{Answer:}

		\bigskip
		\verb|github/super-linter|
		\bigskip
	\else
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\fi

	\item (4 of 20 points) What platform and version do the tests run on?
	
	\beginanswers
		\textbf{Answer:}

		\bigskip
	ubuntu-latest
		\bigskip
	\else
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\fi

	\item (2 of 20 points) One line says which github actions cause the test to run. Rewrite that line so that the test only runs when someone pushes to the repository.
	
	\beginanswers
		\textbf{Answer:}
		
			\bigskip
			\bigskip
		on: [push]
			\bigskip
			\bigskip
	\else
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\fi

	\item (10 of 20 points) Turning to the Python example, create a \textbf{Unit Test} file that runs unit tests on the Mystery code. Your test file should test every function in Mystery. All functions should have at least one passing test. Two of the functions have obvious errors. You should provide tests that demonstrate these error cases as well.
	
	\beginanswers
		\textbf{Answer:}

		\bigskip
		
		\lstinputlisting{code/Testing/test_mystery.py}
		\bigskip
	\else
	\bigskip

\hspace*{-0.4in}\framebox(500,380){}

	\bigskip

	\fi

	\item (2 of 20 points) In our class notes we discussed \textbf{White Box}, \textbf{Black Box} and \textbf{Grey Box} testing. The testing we did in the previous question falls into which of these cattegories?	
	
	\beginanswers
		\textbf{Answer:}

		\bigskip
White Box (You looked at the code to determine the correct response and the error conditions)
		\bigskip
	\else
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\fi

\end{enumerate}
	
\newpage


\item (20 points) We have an issue (https://github.com/rcos/CSCI-4470-OpenSource/issues) in the class issue tracker to \textbf{Dockerify} our \textbf{Tensorflow} lab. To refresh your memory, here are the lines that we had to execute to fully provision our Docker container so we could use it:

\begin{lstlisting}
	> docker run -it -p 8888:8888 -e "DISPLAY"=host.docker.internal:0 tensorflow/tensorflow:latest
	> apt-get update
	> apt-get install python-tk xterm x11-apps qt5-default
	> apt-get install vim
	> pip install matplotlib PyQt5
\end{lstlisting}

Note that this includes adding in an editor.  You may also remember that the \verb*|Tensorflow| container puts you in the root of  file system as the \verb*|root| user. We will want to change this. 

In your Dockerfile you should:
\begin{itemize} 
	\item provision the above requirements, 
	\item create a directory \verb*|/home/tensorflow|, 
	\item create a user \verb*|tensorflow|,
	\item make the user and the directory you created the defaults when you run the image interactively 
	\item finally, we want to run this intractively just like the original image. Make sure you invoke \verb*|bash| at the end of the \verb*|Dockerfile|
\end{itemize}

	\begin{enumerate} 
		\item (16/20 points) Write a \verb|Dockerfile| to provision the container described above.

\beginanswers
\lstinputlisting{code/Docker/Dockerfile}
\else
\hspace*{-0.4in}\framebox(540,400){}
\fi

\item (2/20 points) What commands would be used to generate a container named \verb|mytensorflow| under dockerhub account \verb*|csci4470| and with version \verb*|v1.0|from this Dockerfile, and then push them to Dockerhub? 
	You can assume you are in
	the same directory as the file and are already logged into the \verb*|csci4470| account.

\beginanswers
			\begin{lstlisting}
			docker build -t csci4470/mytensorflow:v1.0 .
			docker push csci4470/mytensorflow:v1.0
			\end{lstlisting}
\else
\hspace*{-0.4in}\framebox(540,200){}
\fi

\item (2/20 points) What command would be used to run the container you just created so that it 
	comes up in interactive mode with a terminal prompt? Be sure to start from the command above and make sure you map the container directory \verb*|/home/tensorflow| to the directory \verb*|/User/tensorflow/data| on the host machine.

\beginanswers
			\begin{lstlisting}
				docker run -it -p 8888:8888 -v /User/tensorflow/data:/home.tensorflow -e "DISPLAY"=host.docker.internal:0 csci4470/mytensorflow:v1.0
			\end{lstlisting}
\else
\hspace*{-0.4in}\framebox(540,200){}
\fi

\end{enumerate}

\newpage

\item   (20 points) In class we used Tensorflow utilities to manually find the $2$ coefficients $m$ and $b$ of the 
	linear equation $y = m*x + b$. In lab we used Keras to predict types of clothing. For this question, we will use Keras to predict the values of the linear 
	equation we solved in class. This is probably the most difficult problem on the
	test, but I am providing lots of code. You just need to fill in the blanks.
	
	The graph below shows a successful run of the completed code. The blue background is a scatterplot of the input data while the double line in the center is the actual line and the prediction from Tensorflow lying overtop of one another.


\begin{center}
\includegraphics[width=0.6\linewidth]{images/linear.png}
\end{center}

Fill in the missing code below. The comments will tell you what you need to do.

\beginanswers

\textbf{Answer:}

\lstinputlisting{code/Tensorflow/data/linear.py}

\else

\lstinputlisting{code/Tensorflow/data/linear_1.py}

\lstinputlisting{code/Tensorflow/data/linear_2.py}

\fi

model = 

\newpage

\lstinputlisting{code/Tensorflow/data/linear_3.py}

test\_loss, test\_acc = 

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip

\lstinputlisting{code/Tensorflow/data/linear_4.py}

predictions = 

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip

\lstinputlisting{code/Tensorflow/data/linear_5.py}

%\else
%\hspace*{-0.4in}\framebox(540,700){}
%\fi
\newpage

\begin{center}
	\begin{LARGE}
\textbf{Use this page for scratch.}	\end{LARGE}
\end{center}

\newpage
\begin{center}
	\begin{LARGE}
		\textbf{Use this page for scratch.}	\end{LARGE}
\end{center}

\newpage

\begin{center}
	\begin{LARGE}
		\textbf{Use this page for scratch.}	\end{LARGE}
\end{center}
\newpage

\begin{center}
	\begin{LARGE}
		\textbf{Use this page for scratch.}	\end{LARGE}
\end{center}

\end{enumerate}
\end{document}
